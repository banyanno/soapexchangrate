Imports System Imports System.ServiceModel.Description Imports System.ServiceModel.Channels Imports System.Configuration Imports System.ServiceModel Imports System.Xml Imports System.Net Imports System.Text  Public Class Form1     Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click         Dim Client As New Calculator1.Service1SoapClient()         If RadioButton1.Checked = True Then             MessageBox.Show(Client.Add(txt1.Text, Txt2.Text))         End If         If RadioButton2.Checked = True Then             MessageBox.Show(Client.Subtract(txt1.Text, Txt2.Text))         End If         If RadioButton3.Checked = True Then             MessageBox.Show(Client.Multiply(txt1.Text, Txt2.Text))         End If         If RadioButton4.Checked = True Then             MessageBox.Show(Client.Division(txt1.Text, Txt2.Text))         End If     End Sub      Private Sub Form1_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load      End Sub      Private Sub Button2_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button2.Click         PostTotal("http://localhost:777/webservice/Service1.asmx?op=Division")     End Sub     Private Sub PostTotal(ByVal m_URL As String)          'Try         Dim request As Net.HttpWebRequest = Net.HttpWebRequest.Create(m_URL)         request.Method = "POST"         request.ContentType = "text/xml"         request.Headers.Add("SOAPAction", "http://tempuri.org/Division")         ' request.Headers.Add(HttpRequestHeader.AcceptEncoding, "gzip,deflate")         Dim m_PostMSG As String = "<?xml version=""1.0"" encoding=""utf-8""?>" & _         "<soap:Envelope xmlns:xsi=""http://www.w3.org/2001/XMLSchema-instance"" xmlns:xsd=""http://www.w3.org/2001/XMLSchema"" xmlns:soap=""http://schemas.xmlsoap.org/soap/envelope/"">" & _         "<soap:Body>" & _         "<Division xmlns=""http://tempuri.org/"">" & _         "<x>" & txt1.Text & "</x>" & _         "<y>" & Txt2.Text & "</y>" & _         "</Division>" & _         "</soap:Body>" & _         "</soap:Envelope>"          'request.ContentLength = m_PostMSG.Length         '"<soap:Envelope xmlns:soap=""http://schemas.xmlsoap.org/soap/envelope/"" xmlns:ws=""http://ws.mrted.com/"">" & _         '    "<soap:Header>" & _         '    "<wsse:Security xmlns:wsse=""http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd"">" & _         '    "<wsse:UsernameToken wsu:Id=""UsernameToken-3"" xmlns:wsu=""http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd"">" & _         '    "<wsse:Username>THubUser</wsse:Username>" & _         '    "<wsse:Password Type=""http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText"">Password1234</wsse:Password>" & _         '    "</wsse:UsernameToken>" & _         '    "</wsse:Security>" & _         '    "</soap:Header>" & _         '    "<soap:Body>" & _         '    "<ws:getPositionById>" & _         '    "<id>1234</id>" & _         '    "</ws:getPositionById>" & _         '    "</soap:Body>" & _         '    "</soap:Envelope>"          MsgBox(m_PostMSG)          Dim objStream As New System.IO.StreamWriter(request.GetRequestStream(), System.Text.Encoding.UTF8)         objStream.Write(m_PostMSG, 0, m_PostMSG.Length)         objStream.Close()         objStream = Nothing          Dim objHTTPRes As HttpWebResponse         objHTTPRes = request.GetResponse         Dim SourceStream As IO.Stream = objHTTPRes.GetResponseStream()         Dim objXML As New System.Xml.XmlDocument()         objXML.Load(SourceStream)         Dim ret As String         Dim sr As System.IO.StreamReader = New IO.StreamReader(SourceStream)         ret = sr.ReadToEnd         objXML.Save("C:\a.xml")         'Catch ex As Exception         '    MsgBox(ex.Message)         'End Try        End Sub End Class 